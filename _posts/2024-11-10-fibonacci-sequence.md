---
layout: post
title: "斐波那契数列"
date: 2024-11-10 10:03:42 +0800
categories: [ "data-structure" ]
---

在数学中，斐波那契数列是一个序列，其中每个数字是前两个数字之和。属于斐波那契数列的数字称为斐波那契数，通常表示为 $F_n$。该序列通常从 0 和 1 开始，依次为：

0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, ...

斐波那契数可以通过递推关系定义：

$$
F_{0}=0,\quad F_{1}=1,
$$

并且

$$
F_{n}=F_{n-1}+F_{n-2}
$$

对于 $n > 1$。

前 20 个斐波那契数 $F_n$ 为：

| $F_0$ | $F_1$ | $F_2$ | $F_3$ | $F_4$ | $F_5$ | $F_6$ | $F_7$ | $F_8$ | $F_9$ |
|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| 0     | 1     | 1     | 2     | 3     | 5     | 8     | 13    | 21    | 34    |

| $F_{10}$ | $F_{11}$ | $F_{12}$ | $F_{13}$ | $F_{14}$ | $F_{15}$ | $F_{16}$ | $F_{17}$ | $F_{18}$ | $F_{19}$ |
|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| 55       | 89       | 144      | 233      | 377      | 610      | 987      | 1597     | 2584     | 4181     |

## 如何找到斐波那契数列的通项公式？

我们希望找到一个公式，可以直接计算第 $ n $ 项的值，而不必逐个计算前面的项。这需要一些数学技巧。

### 假设解的形式

由于递推公式是线性且齐次的，我们可以假设解的形式为：

$$
F_n = r^n
$$

其中，$ r $ 是待定的常数。

### 代入递推公式

将假设的解代入递推公式，得到：

$$
r^n = r^{n-1} + r^{n-2}
$$

两边同时除以 $ r^{n-2} $，得到：

$$
\frac{r^n}{r^{n-2}} = \frac{r^{n-1}}{r^{n-2}} + \frac{r^{n-2}}{r^{n-2}}
$$

简化指数：

$$
r^{n-(n-2)} = r^{(n-1)-(n-2)} + 1
$$

因此得到：

$$
r^2 = r + 1
$$

### 求特征方程的根

这个方程称为特征方程：

$$
r^2 - r - 1 = 0
$$

这是一个关于 $ r $ 的二次方程，我们可以用求根公式求解：

对于一般的二次方程 $ ax^2 + bx + c = 0 $，其求根公式为：

$$
x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}
$$

将 $ a = 1 $，$ b = -1 $，$ c = -1 $ 代入，得到：

$$
r = \frac{-(-1) \pm \sqrt{(-1)^2 - 4 \times 1 \times (-1)}}{2 \times 1} = \frac{1 \pm \sqrt{5}}{2}
$$

$$
r = \frac{1 \pm \sqrt{5}}{2}
$$

因此，得到两个特征根：

- $ \phi = \dfrac{1 + \sqrt{5}}{2} $  （黄金分割比）
- $ \psi = \dfrac{1 - \sqrt{5}}{2} $

### 写出通解

由于递推关系是线性的，其通解是特征解的线性组合：

$$
F_n = A \phi^n + B \psi^n
$$

其中，$ A $ 和 $ B $ 是待定系数。

### 确定系数 $ A $ 和 $ B $

利用初始条件 $ F_0 $ 和 $ F_1 $ 来求解 $ A $ 和 $ B $。

**当 $ n = 0 $ 时：**

$$
F_0 = A \phi^0 + B \psi^0
$$

由于任何数的 0 次方都是 1，所以：

$$
0 = A + B \quad \text{（1）}
$$

**当 $ n = 1 $ 时：**

$$
F_1 = A \phi^1 + B \psi^1
$$

即：

$$
1 = A \phi + B \psi \quad \text{（2）}
$$

**解方程组（1）和（2）：**

从方程（1）得：

$$
B = -A
$$

将 $ B $ 代入方程（2）：

$$
1 = A \phi - A \psi = A (\phi - \psi)
$$

**计算 $ \phi - \psi $：**

$$
\phi - \psi = \left( \dfrac{1 + \sqrt{5}}{2} \right) - \left( \dfrac{1 - \sqrt{5}}{2} \right) = \dfrac{2 \sqrt{5}}{2} = \sqrt{5}
$$

所以：

$$
A \cdot \sqrt{5} = 1
$$

解得：

$$
A = \dfrac{1}{\sqrt{5}}
$$

因此：

$$
B = -A = -\dfrac{1}{\sqrt{5}}
$$

### 写出最终的通项公式

将 $ A $ 和 $ B $ 的值代入通解，得到斐波那契数列的通项公式：

$$
F_n = \dfrac{1}{\sqrt{5}} \left( \phi^n - \psi^n \right)
$$

其中：

- $ \phi = \dfrac{1 + \sqrt{5}}{2} $
- $ \psi = \dfrac{1 - \sqrt{5}}{2} $

## 验证通项公式

**例子：计算第 6 项**

让我们用通项公式计算第 6 项，看是否与已知结果一致。

**计算 $ \phi^6 $ 和 $ \psi^6 $：**

- $ \phi^6 = \left( \dfrac{1 + \sqrt{5}}{2} \right)^6 \approx 17.9443 $
- $ \psi^6 = \left( \dfrac{1 - \sqrt{5}}{2} \right)^6 \approx (-0.9443) $

**代入通项公式：**

$$
F_6 \approx \dfrac{1}{\sqrt{5}} (17.9443 - (-0.9443)) \approx \dfrac{1}{\sqrt{5}} (17.9443 + 0.9443) \approx \dfrac{18.8886}{2.2361} \approx 8.0
$$

我们得到的结果为 8，与斐波那契数列的第 6 项一致。

## 总结

通过对递推公式的分析和解特征方程，我们找到了斐波那契数列的通项公式：

$$
F_n = \dfrac{1}{\sqrt{5}} \left( \left( \dfrac{1 + \sqrt{5}}{2} \right)^n - \left( \dfrac{1 - \sqrt{5}}{2} \right)^n \right)
$$

这个公式允许我们直接计算斐波那契数列的任意一项，而无需逐项计算，非常方便。
